\documentclass[twoside,10pt]{article}
\input{macro.tex}

\begin{document}

\title{CSE 6643 Homework 3}
\author{Sch{\"a}fer, Spring 2023}
\date{Deadline: Feb. 21 Tuesday, 8:00 am}
\maketitle

\begin{itemize}
  \item There are 2 sections in grade scope: Homework 3 and Homework 3 Programming. Submit your answers as a PDF file to Homework 3 (report the results that you obtain using programming by using plots, tables, and a description of your implementation like you would when writing a paper.) and also submit your code in a zip file to Homework 3 Programming. 
  \item Programming questions are posted in Julia. You are allowed to use basic library functions like sorting, plotting, matrix-vector products etc, but nothing that renders the problem itself trivial. Please use your common sense and ask the instructors if you are unsure. 
  You should never add additional packages to the environment.
  \item Late homework incurs a penalty of 20\% for every 24 hours that it is late. Thus, right after the deadline, it will only be worth 80\% credit, and after four days, it will not be worth any credit. 
  \item We recommend the use of LaTeX for typing up your solutions. No credit will be given to unreadable handwriting.
  \item List explicitly with whom in the class you discussed which problem, if any. Cite all external resources that you were using to complete the homework. For details, consult the collaboration policy in the class syllabus on canvas.
\end{itemize}

\section{One-upping [25 pts]}
Let $\mtx{A} \in \R^{m \times m}$ have full rank. Assume that we have already computed the QR decomposition of $\mtx{A}$.
For $\mtx{u}, \mtx{v} \in \R^m$, we call the matrix $\mtx{B} = \mtx{A} + \mtx{u}\mtx{v}^{T}$ a rank-1 update of $\mtx{A}$. 

\subsection*{(a) [5 pts]}
Prove that if $\vct{v}^{T} \mtx{A}^{-1} \vct{u} \neq - 1$, then $\mtx{B}$ is invertible.

\subsection*{(b) [10 pts]} 
Design an algorithm that provably solves the system of equations $\mtx{B} \mtx{x} = \mtx{b}$ in $O(m^2)$ operations. 

\subsection*{(c) r-upping [10 pts]}
Extend the algorithm from the previous exercise to the case of $\mtx{B} = \mtx{A} + \mtx{U}\mtx{V}^{T}$, for $\mtx{U},\mtx{V} \in \R^{m \times r}$ and $r \ll m$.
Calculate the asymptotic complexity of the resulting algorithm.

\section{You Factor [25 pts]}
In class we have seen that if $\tilde{\vct{x}} \in \R^{m}$ is the solution to the system $\mtx{A}\vct{x} = \vct{b}$, as computed by unpivoted LU factorization, we have  
\begin{equation}
  \left(\mtx{A} + \mtx{E}\right)\tilde{\vct{x}} = \vct{b}.  
\end{equation}
For $u$ the unit roundoff error and $\tilde{\mtx{L}}, \tilde{\mtx{U}}$ the LU factors computed in finite precision, we have
\begin{equation}
  \left|\mtx{E}\right| \leq m u \left(2 \left|\mtx{A}\right| + 4 \left|\tilde{\mtx{L}} \right| \left|\tilde{\mtx{U}}\right|\right) + O(u^2).
\end{equation}
Here, $|\cdot|$ signifies the element-wise absolute values and $\leq$ is interpreted element-wise, as well.
In this problem, we investigate the conclusions from this bound in the case of row-pivoted LU factorization.

\subsection*{(a) [7.5 pts]}
Deduce that under row-pivoted $LU$ factorization and taking $\| \cdot \|_{\infty}$ to signify the vector-infinity norm, we have 
\begin{equation}
  \left\|\mtx{E}\right\|_{\infty} \leq m u \left(2 \left\|\mtx{A}\right\|_{\infty} + 4 m \left\|\tilde{\mtx{U}}\right\|_{\infty} \right) + O(u^2).
\end{equation}
This prompts us to investigate the growth factor $\rho \coloneqq \frac{\left\| \mtx{U} \right\|_{\infty}}{\left\|\mtx{A}\right\|_{\infty}}$ of row-pivoted LU factorization.

\subsection*{(b) [5 pts]}
Verify that the rows $\vct{u}_{i}^{T}, \vct{a}_{i}^{T}$ of $\mtx{U}, \mtx{A}$ satisfy 
\begin{equation}
  \vct{u}_{i}^{T} = \vct{a}_i^T - \sum \limits_{j = 1}^{i - 1} \mtx{L}_{ij} \vct{u}_{j}^T.
\end{equation}

\subsection*{(c) [5 pts]}
Use part (b) to show that $\left\|\tilde{\mtx{U}}\right\|_{\infty} \leq 2^{m - 1} \left\| \mtx{A}\right\|_{\infty}$. 

\subsection*{(d) [7.5 pts]} Consider matrices of the form 
\begin{equation}
  \mtx{A} = 
  \begin{pmatrix}
    1  &    &   &       & 1 \\
    -1 & 1  &   &       & 1 \\
    -1 & -1 & 1 &       & 1 \\
    -1 & -1 & -1 &    1 & 1 \\
    -1 & -1 & -1 &  - 1 & 1 
  \end{pmatrix}.
\end{equation}
Derive the growth factor in this case as a function of $m$. 
How does this relate to part (c)? 

\section{[25 pts]}
Suppose that $\mtx{A} \in \K^{m \times m}$ is strictly column diagonally dominant, meaning that for all $1 \leq k \leq m$, 
\begin{equation}
  \left|\mtx{A}_{kk}\right| > \sum \limits_{j \neq k} \left|\mtx{A}_{jk}\right|.
\end{equation}
Show that if LU factorization with row pivoting is applied to $\mtx{A}$, no row interchange takes place.

\section{Pivoting [25 pts]}
\subsection*{(a) [5 pts]} 
Go to section (a) of the file \texttt{HW3\_your\_code.jl} and implement a function that takes in a matrix $\mathtt{LU} \in \K^{m \times m}$ containing the upper triangular part of $\mtx{U}$ as well as the strict lower triangular part of $\mtx{L}$, as well as an array $\mathtt{P} \in \{1, \ldots m\}^{m}$ that encodes the permutation matrix $\mtx{P}$ by $\mathtt{P}[j] = i \Leftrightarrow \mtx{P_{ij}} = 1$.
Your function should not allocate any memory. 


\subsection*{(b) [5 pts]} 
Go to section (b) of the file \texttt{HW3\_your\_code.jl} and implement the unpivoted LU factorization. 
Check your code by ensuring that the assertions in section a + b of \texttt{HW3\_driver.jl} do not produce any errors.

\subsection*{(c) [5 pts]}
Generate families of random $m \times m$ matrices and vectors of length $m$. 
Plot as a function of the size $m$, the relative error of the solution obtained from your code in parts (a,b) and the growth factor introduced in problem 2.
Report the floating point type used by your program.
You can use the code provided in the second homework as a starting point for creating and saving plots.

\subsection*{(d) [5 pts]}
Go to section (d) of the file \texttt{HW3\_your\_code.jl} and implement the unpivoted LU factorization. 
Your code should pass the assertions in section (c) of \texttt{HW3\_driver.jl}.
Your function should take the matrix $A$ as an input to modify in place, and return an integer array $P$ according to the specifications of (a).
Repeat the experiment of (c) using the pivoted LU factorization. 


\subsection*{(e) [5 pts]}
Go to section (e) of the file \texttt{HW3\_driver.jl} and implement a function that takes an integer $m$ as an input and returns an $m \times m$ matrix as introduced in problem 2 (d).
Plot the error of the solution when solving equations in this matrix as a function of $m$. 
Compare the error to the built-in solution (the $\backslash$ operator). 
Draw your conclusions from this comparison. 


\end{document}
